\documentclass{article}
\usepackage{geometry}
\geometry{landscape, margin=5mm}
\usepackage{amsmath}
\usepackage{xcolor}
\definecolor{k}{HTML}{F94144}
\definecolor{o}{HTML}{E8960E}
\definecolor{zh}{HTML}{F9C74F}
\definecolor{z}{HTML}{90BE6D}
\definecolor{g}{HTML}{4D908E}
\definecolor{s}{HTML}{277DA1}
\definecolor{f}{HTML}{AA3DAA}
\definecolor{gray}{HTML}{F0F0F6}
%\definecolor{gray}{HTML}{E4E8EE}

\newcommand{\D}[2]{\frac{\partial #1}{\partial #2}}

\begin{document}
%\pagecolor{gray}

\section{Polynomials}

$P_M$ is the order $M$ (shifted) Legendre polynomial on the range $[0,1]$.

It has $M$ roots: $0<\xi_i<1$, $i=0..M-1$.

Gauss Legendre quadrature can be used:

\begin{equation}
  \int_0^1 d\xi f(\xi) = \sum_{i=0}^{M-1} w_i f(\xi_i) 
\end{equation}

It is accurate if $f(\xi)$ is a polynomial of order less or equal to $2M-1$. 

Let us construct $M$ Lagrange polynomials $\psi_i$, $i=0..M-1$, interpolating the roots:
\begin{equation}
  \psi_j(\xi_i) = \delta_{ij}.
\end{equation}
Found as
\begin{equation}
  \psi_j(\xi) = \prod_{i\ne j} \frac{x-x_i}{x_j-x_i}.
\end{equation}
Their order is $M-1$.

They can be integrated:
\begin{equation}
  \int_0^1 d\xi \psi_l(\xi) = \sum_{i=0}^{M-1} w_i \psi_l(\xi_i)  = w_l
\end{equation}
and this is how the Gauss weights are found. 

Orthogonality works as
\begin{equation}
  \int_0^1 d\xi \psi_l(\xi) \psi_k(\xi) = \sum_{i=0}^{M-1} w_i \psi_l(\xi_i) \psi_k(\xi_i) = w_l \delta_{kl}.
\end{equation}

And one more useful expression:
\begin{equation}
  \int_0^1 d\xi \D{\psi_l(\xi)}\xi \psi_k(\xi) = \sum_{i=0}^{M-1} w_i \left. \D{\psi_l}{\xi}\right|_{\xi_i} \psi_k(\xi_i) = w_k \left. \D{\psi_l}{\xi}\right|_{\xi_k}.
\end{equation}

To project a function $f(\xi)$ onto the basis
\begin{equation}
  f(\xi) = \sum_{l=0}^{M-1} f_l \psi(\xi) 
\end{equation}
the coefficients are found as
\begin{equation}
  f_l = f(\xi_l).
\end{equation}

\clearpage
\section{DG} \label{sec:DG}

\begin{equation} \label{init}
 \D {\color{o} u_p} {t} + 
 \D {\color{o} F_p (\pmb u)}{x} = 
  {\color{o} S_p(\pmb u, x, t)} \quad
\end{equation}

\begin{align}
  \tau^{(k)}(t) = \frac{t-t^{(k)}}{\Delta t}; \\
  \xi^{(m)}(x) = \frac{x-x^{(m)}}{\Delta x}. \\
  \xi^{(m)} \equiv \xi; \quad  \tau^{(k)} \equiv \tau.
\end{align}


\begin{equation} 
  \pmb F^* = \frac{\Delta t}{\Delta x} \pmb F; \quad
  \pmb S^* =       \Delta t            \pmb S.
\end{equation}

\begin{equation} \label{DG}
\left.
\left.
 \D {\color{o} u_p} {\tau} + 
 \D {\color{o} F^*_p (\pmb u)}{\xi} = 
  {\color{o} S^*_p(\pmb u, \xi(x), \tau(t))} \quad
 \right| 
 {\color{z} \cdot
  \psi_{k_\xi} (\xi) }
 \right| 
 {\color{z} \cdot 
  \int_0^1 d\xi
  \int_0^1 d\tau}
\end{equation}

lk\begin{equation}
  \int_0^1 \D {u_p}{\tau} d\tau = \left. u_p \right|_{\tau=1} -  \left. u_p \right|_{\tau=0}.
\end{equation}

\begin{align} 
  \left. u_p \right|_{\tau=0} \approx 
  {\color{f} \mathsf{w}_{pl_\xi} } 
  {\color{o} \psi_{l_\xi} (\xi(x)) }\\
  \left. u_p \right|_{\tau=1} \approx 
  {\color{k} \mathsf{u}^+_{pl_\xi} } 
  {\color{o} \psi_{l_\xi} (\xi(x)) }
\end{align}

\begin{equation}
  {\color{k} \mathsf{u}^+_{pl_\xi} }
  \langle {\color{o} \psi_{l_\xi} (\xi(x)) } 
  {\color{z} \psi_{k_\xi} (\xi) } \rangle -
  {\color{f} \mathsf{w}_{pl_\xi} } 
  \langle {\color{o} \psi_{l_\xi} (\xi(x)) } 
  {\color{z} \psi_{k_\xi} (\xi) } \rangle + 
  {\color{z} \int_0^1 d\tau \left( 
  \left.
  {\color{s} \mathsf{F}_\text{right}  }
  \psi_{k_\xi} 
  \right|_{\xi=1}
  - 
  \left.
  {\color{s} \mathsf{F}_\text{left}  }
  \psi_{k_\xi} 
  \right|_{\xi=0}
  -
  \int_0^1 
  {\color{o} F_p (\pmb u)}
  \D{\psi_{k_\xi}}{\xi}
  d\xi
  \right) = }
 {\color{z}  
  \int_0^1 d\xi
  \psi_{k_\xi} (\xi) 
  \int_0^1 d\tau}
  {\color{o} S_p}.
\end{equation}

\begin{equation}
  {\color{k} \mathsf{u}^+_{pk_\xi} }
  w_{k_\xi}  = 
  {\color{f} \mathsf{w}_{pk_\xi} } 
  w_{k_\xi}  - 
  {\color{z} \int_0^1 d\tau \left( 
  \left.
  {\color{s} \mathsf{F}_\text{right}  }
  \psi_{k_\xi} 
  \right|_{\xi=1}
  - 
  \left.
  {\color{s} \mathsf{F}_\text{left}  }
  \psi_{k_\xi} 
  \right|_{\xi=0}
  -
  \int_0^1 
  {\color{o} F_p (\pmb u)}
  \D{\psi_{k_\xi}}{\xi}
  d\xi
  \right) + }
 {\color{z}  
  \int_0^1 d\xi
  \psi_{k_\xi} (\xi) 
  \int_0^1 d\tau}
  {\color{o} S_p}.
\end{equation}
\section{ADER} \label{sec:ADER}

\begin{equation} \label{localADERinit}
\left.
\left.
 \D {\color{o} u_p} {\tau} + 
 \D {\color{o} F^*_p (\pmb u)}{\xi} = 
 {\color{o} S^*_p} \quad
 \right| 
 {\color{z} \cdot
  \theta_k (\xi,\tau) }
 \right| 
 {\color{z} \cdot \int_0^1 d\xi
  \int_0^1 d\tau }
\end{equation}

\begin{equation}
 {\color{o} u_p} \approx 
 {\color{k} q_p (\xi,\tau)} = 
 {\color{k} q_{pl_\xi l_\tau} } 
 {\color{o} \psi_{l_\xi}(\xi)
            \psi_{l_\tau}(\tau) } = 
 {\color{k} q_{pl_\xi l_\tau} } 
 {\color{o} \theta_{l}(\xi,\tau) }
\end{equation}
\begin{equation}
{\color{z} \theta_l (\xi,\tau)= \psi_{l_\xi}(\xi)
            \psi_{l_\tau}(\tau) }
\end{equation}

\begin{equation}
{\color{o} F^*_p(\pmb u)} = 
{\color{k} \mathcal{F}_{pl} }
{\color{o} \theta_{l}(\xi,\tau) }; \quad {\color{k} \mathcal{F}_{pl}  \approx  F^*_p(\pmb q) }
\end{equation}

\begin{equation}
{\color{o} S^*_p(\pmb u)} = 
{\color{k} \mathcal{S}_{pl} }
{\color{o} \theta_{l}(\xi,\tau) }; \quad {\color{k} \mathcal{S}_{pl}  \approx  S_p(\pmb q) }
\end{equation}

\begin{equation}
 {\color{z} \int_0^1 \int_0^1 }
 \D {\color{o} u_p} {\tau} 
 {\color{z} \theta_k (\xi,\tau) }
 {\color{z} d\xi d\tau } =
 {\color{z}
   \int_0^1 \left( 
     {\color{o} u_p} 
     \left. \theta_{k} \right|_{\tau=0}^{\tau=1} - 
     \int_0^1 {\color{o} u_p}
     \D{\theta_k}{\tau} d\tau
   \right) d\xi.
 }
\end{equation}


\begin{equation}
 {\color{o}
  u_p(\tau=0) } = 
 {\color{f} w_{pl_\xi}}
 {\color{o} \psi_{l_\xi}(\xi) } ; \quad
 {\color{k} q_{pl}}{\color{o}\psi_{l_\tau}(0)} = {\color{f} w_{pl_\xi}}
\end{equation}

\begin{equation}
 {\color{o}
  u_p(\tau=1) } = 
 {\color{k} q_{pl}}
 {\color{o} \psi_{l_\tau}(1) }
 {\color{o} \psi_{l_\xi}(\xi) }
\end{equation}

\begin{align} \begin{split}
 {\color{z} \cdot \int_0^1 \int_0^1 }
 \D {\color{o} u_p} {\tau} 
 {\color{z} \theta_k (\xi,\tau) }
 {\color{z} d\xi d\tau }  =
 {\color{k} q_{pl}}
 {\color{o} \psi_{l_\tau}(1) }
 {\color{z} \psi_{k_\tau}(1) } 
 {\color{z} \int_0^1 }
 {\color{o} \psi_{l_\xi}(\xi) }
 {\color{z} \psi_{k_\xi}(\xi) d\xi} - 
 {\color{f} w_{pl_\xi}}
 {\color{z} \psi_{k_\tau}(0) } 
 {\color{z} \int_0^1 }
 {\color{o} \psi_{l_\xi}(\xi) }
 {\color{z} \psi_{k_\xi}(\xi) d\xi} - 
 {\color{k} q_{pl}}
 {\color{z} \int_0^1 } 
 {\color{o} \psi_{l_\xi}(\xi) }
 {\color{z} \psi_{k_\xi}(\xi) d\xi} 
 {\color{z} \int_0^1 }
 {\color{o} \psi_{l_\tau}(\tau) }
 {\color{z} \D{\psi_{k_\tau}(\tau)}{\tau} d\tau} .
\end{split}\end{align}

\begin{equation}
 { \int_0^1 }
 { \psi_{l_\xi}(\xi) }
 { \psi_{k_\xi}(\xi) d\xi  = \delta_{l_\xi k_\xi} \mathsf{w}_{k_\xi}}.
\end{equation}


Finally, from (\ref{localADERinit}), we get the system of $k_\xi \cdot k_\tau$ equations:
\begin{align} \begin{split}
  {\color{k} q_{pl}}
  {\color{z} \delta_{l_\xi k_\xi} \mathsf{w}_{k_\xi}} 
  \left(
     {\color{o} \psi_{l_\tau}(1) }
     {\color{z} \psi_{k_\tau}(1) } - 
     {\color{z} \int_0^1 }
     {\color{o} \psi_{l_\tau}(\tau) }
     {\color{z} \D{\psi_{k_\tau}(\tau)}{\tau} d\tau}
  \right) = 
  {\color{f} w_{pl_\xi}}
  {\color{z} \psi_{k_\tau}(0) }
  {\color{z} \delta_{l_\xi k_\xi} \mathsf{w}_{k_\xi}} - 
  {\color{o} \mathcal{F}_{pl_\xi l_\tau}  ( {\color{k} \pmb q_{l}})}
  {\color{z} \int_0^1 } 
  {\color{o} \psi_{l_\tau}(\tau) }
  {\color{z} \psi_{k_\tau}(\tau) d\tau} 
  {\color{z} \int_0^1 }
  {\color{o} \psi_{k_\xi}(\xi) }
  {\color{z} \D{\psi_{l_\xi}(\xi)}{\xi} d\xi} + 
  {\color{z} \int_0^1 } 
  {\color{o} \psi_{l_\tau}(\tau) }
  {\color{z} \psi_{k_\tau}(\tau) d\tau} 
  {\color{z} \int_0^1 }
  {\color{o} \psi_{k_\xi}(\xi) }
  {\color{z} {\psi_{l_\xi}(\xi)}
  {\color{o} \mathcal{S}_{pl_\xi l_\tau} ( {\color{k} \pmb q_{l}}, \xi, \tau) }
  d\xi}.
\end{split}\end{align}

\begin{align} \begin{split}
     { \int_0^1 }
     { \psi_{l_\tau}(\tau) }
     { \D{\psi_{k_\tau}(\tau)}{\tau} d\tau } = 
     \left. \mathsf{w}_{l_\tau} \D{\psi_{k_\tau}}{\tau} \right|_{\tau=\tau_{l_\tau}}
\end{split}\end{align}

\begin{align} \begin{split}
  {\color{k} q_{pl}}
  { \delta_{l_\xi k_\xi} \mathsf{w}_{k_\xi}} 
  \left(
     {\color{o} \psi_{l_\tau}(1) }
     {\color{z} \psi_{k_\tau}(1) } - 
     {\color{z}
     \left. \mathsf{w}_{l_\tau} \D{\psi_{k_\tau}}{\tau} \right|_{\tau=\tau_{l_\tau}}
     }
  \right) = 
  {\color{f} w_{pk_\xi}}
  {\color{z} \psi_{k_\tau}(0) }
  {\color{z} \mathsf{w}_{k_\xi}} - 
  {\color{o} \mathcal{F}_{pl}  ( {\color{k} \pmb q_{l}})}
  \delta_{l_\tau k_\tau} \mathsf{w}_{k_\tau} 
     \left. \mathsf{w}_{k_\xi} \D{\psi_{l_\xi}}{\xi} \right|_{\xi=\xi_{k_\xi}} + 
  {\color{o} \mathcal{S}_{pl}  ( {\color{k} \pmb q_{l}})}
  \delta_{l_\tau k_\tau} \mathsf{w}_{k_\tau} 
  \delta_{l_\xi k_\xi} \mathsf{w}_{k_\xi} 
\end{split}\end{align}

\begin{equation}
 K_{1,kl}
 {\color{k} q_l } =
 {\color{f} W_k } - K_{\xi, kl} 
 {\color{o} \mathcal{F}_{pl}  ( {\color{k} \pmb q_{l}})} +
 {\color{o} \mathcal{S}_{pk}  ( {\color{k} \pmb q_{k}})}
\mathsf{w}_{k_\xi} 
\mathsf{w}_{k_\tau} 
\end{equation}

\begin{equation}
 {\color{k} q_m ^{(i+1)} } =
 (K_{1}^{-1})_{mk} \left(
 {\color{f} W_k } - K_{\xi, kl} 
 {\color{o} \mathcal{F}_{pl}  ( {\color{k} \pmb q_{l}^{(i)} })} +
 {\color{o} \mathcal{S}_{pk}  ( {\color{k} \pmb q_{k}^{(i)} })}
\mathsf{w}_{k_\xi} 
\mathsf{w}_{k_\tau} 
 \right)
\end{equation}

\begin{equation}
\boxed{
 {\color{k} q_m ^{(i+1)} } =
 (K_{1}^{-1})_{mk} 
 {\color{f} W_k } -
 (K_{1}^{-1} 
 K_{\xi} )_{ml}
 {\color{o} \mathcal{F}_{pl}  ( {\color{k} \pmb q_{l}^{(i)} })} +
 (K_{1}^{-1})_{mk} 
 {\color{o} \mathcal{S}_{pk}  ( {\color{k} \pmb q_{k}^{(i)} })}
\mathsf{w}_{k_\xi} 
\mathsf{w}_{k_\tau} 
}
\end{equation}

\end{document}
